{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">
    
    <div class="d-flex justify-content-end mb-3 no-print">
        <button onclick="window.print()" class="btn btn-dark">
            <i class="fas fa-print"></i> Print Report
        </button>
    </div>

    <div class="card shadow p-4" id="print-area">
        <div class="text-center mb-4">
            <h2 class="fw-bold">KINARI PRIMARY SCHOOL</h2>
            <h4>Official Student Report Card</h4>
            <hr>
        </div>

        <div class="row mb-4">
            <div class="col-md-2">
                {% if student.passport_photo %}
                    <img src="{{ student.passport_photo.url }}" class="img-thumbnail" style="width: 150px; height: 150px; object-fit: cover;">
                {% else %}
                    <div class="d-flex align-items-center justify-content-center bg-light border" style="width: 150px; height: 150px;">No Photo</div>
                {% endif %}
            </div>
            <div class="col-md-8">
                <p class="fs-5"><strong>Name:</strong> {{ student.first_name }} {{ student.last_name }}</p>
                <p class="fs-5"><strong>Admission No:</strong> {{ student.admission_number }}</p>
                <p class="fs-5"><strong>Class:</strong> {{ student.grade_class }}</p>
            </div>
        </div>

        <h5 class="fw-bold text-decoration-underline mb-3">Assessment Results</h5>

        <table class="table table-bordered border-dark">
            <thead class="table-light">
                <tr>
                    <th style="width: 25%;">Subject</th>
                    <th class="text-center" style="width: 10%;">Level</th>
                    <th class="text-center" style="width: 10%;">Grade</th>
                    <th>Interpretation / Remarks</th>
                </tr>
            </thead>
            <tbody>
                {% for result in results %}
                <tr>
                    <td>{{ result.subject }}</td>
                    
                    <td class="text-center fw-bold">{{ result.performance_level }}</td>
                    
                    <td class="text-center">{{ result.short_grade }}</td>
                    
                    <td class="small fst-italic">{{ result.interpretation }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="4" class="text-center">No assessment results uploaded yet.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <div class="mt-4 p-3 bg-light border rounded">
            <small><strong>KEY:</strong> EE (Exceeding Expectations), ME (Meeting Expectations), ApE (Approaching Expectations), BE (Below Expectations)</small>
        </div>

        <div class="mt-5">
            <div class="row">
                <div class="col-6">
                    <p><strong>Class Teacher Sig:</strong> ___________________</p>
                </div>
                <div class="col-6 text-end">
                    <p><strong>Headteacher Sig:</strong> ___________________</p>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    @media print {
        .no-print { display: none; }
        body * { visibility: hidden; }
        #print-area, #print-area * { visibility: visible; }
        #print-area { position: absolute; left: 0; top: 0; width: 100%; }
    }
</style>
{% endblock %}